# playbook.yml
---
- name: Apply configuration change to routers
  hosts: routers
  gather_facts: no
  tasks:
    - name: Gather current running config
      ios_command:
        commands:
          - show running-config
      register: running_config

    - name: Ensure ACL configuration is present
      ios_config:
        lines:
          - ip access-list standard TEST_ACL
          - permit {{ ip_range }} {{ wildcard_mask }}
        match: line
        replace: line
      when: "'ip access-list standard TEST_ACL' not in running_config.stdout[0] or 'permit {{ ip_range }} {{ wildcard_mask }}' not in running_config.stdout[0]"
